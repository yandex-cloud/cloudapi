syntax = "proto3";

package yandex.cloud.marketplace.stacklandlicenseapi.v1;

import "google/api/annotations.proto";
import "yandex/cloud/api/operation.proto";
import "yandex/cloud/marketplace/stacklandlicenseapi/v1/license_server.proto";
import "yandex/cloud/marketplace/stacklandlicenseapi/v1/sync.proto";
import "yandex/cloud/operation/operation.proto";

option go_package = "github.com/yandex-cloud/go-genproto/yandex/cloud/marketplace/stacklandlicenseapi/v1;stacklandlicenseapi";
option java_package = "yandex.cloud.api.marketplace.stacklandlicenseapi.v1";

// Service for managing license servers
service LicenseServerService {
  // Register a new license server
  rpc Register(RegisterRequest) returns (operation.Operation) {
    option (google.api.http) = {
      post: "/marketplace/stackland-license/v1/licenseServers:register"
      body: "*"
    };
    option (yandex.cloud.api.operation) = {
      metadata: "RegisterLicenseServerMetadata"
      response: "LicenseServer"
    };
  }

  // Synchronize: get license limits and submit usage data
  rpc SyncUsage(SyncRequest) returns (operation.Operation) {
    option (google.api.http) = {
      post: "/marketplace/stackland-license/v1/licenseServers:syncUsage"
      body: "*"
    };
    option (yandex.cloud.api.operation) = {
      metadata: "SyncUsageMetadata"
      response: "SyncUsageResult"
    };
  }
}
