syntax = "proto3";

package yandex.cloud.organizationmanager.v1.idp.application.saml;

import "google/api/annotations.proto";
import "google/protobuf/field_mask.proto";
import "yandex/cloud/api/operation.proto";
import "yandex/cloud/organizationmanager/v1/idp/application/saml/signature_certificate.proto";
import "yandex/cloud/operation/operation.proto";
import "yandex/cloud/validation.proto";

option go_package = "github.com/yandex-cloud/go-genproto/yandex/cloud/organizationmanager/v1/idp/application/saml;saml";
option java_package = "yandex.cloud.api.organizationmanager.v1.idp.application.saml";

// A set of methods for managing signature certificates for SAML applications.
service SignatureCertificateService {
  // Returns the specified signature certificate.
  //
  // To get the list of available certificates, make a [List] request.
  rpc Get (GetSignatureCertificateRequest) returns (SignatureCertificate) {
    option (google.api.http) = { get: "/organization-manager/v1/idp/application/saml/signature-certificates/{signature_certificate_id}" };
  }

  // Retrieves the list of signature certificates for the specified SAML application.
  rpc List (ListSignatureCertificatesRequest) returns (ListSignatureCertificatesResponse) {
    option (google.api.http) = { get: "/organization-manager/v1/idp/application/saml/signature-certificates" };
  }

  // Creates a new signature certificate for the specified SAML application.
  rpc Create (CreateSignatureCertificateRequest) returns (operation.Operation) {
    option (google.api.http) = { post: "/organization-manager/v1/idp/application/saml/signature-certificates" body: "*" };
    option (yandex.cloud.api.operation) = {
      metadata: "CreateSignatureCertificateMetadata"
      response: "SignatureCertificate"
    };
  }

  // Updates the specified signature certificate.
  rpc Update (UpdateSignatureCertificateRequest) returns (operation.Operation) {
    option (google.api.http) = { patch: "/organization-manager/v1/idp/application/saml/signature-certificates/{signature_certificate_id}" body: "*" };
    option (yandex.cloud.api.operation) = {
      metadata: "UpdateSignatureCertificateMetadata"
      response: "SignatureCertificate"
    };
  }

  // Deletes the specified signature certificate.
  rpc Delete (DeleteSignatureCertificateRequest) returns (operation.Operation) {
    option (google.api.http) = { delete: "/organization-manager/v1/idp/application/saml/signature-certificates/{signature_certificate_id}" };
    option (yandex.cloud.api.operation) = {
      metadata: "DeleteSignatureCertificateMetadata"
      response: "google.protobuf.Empty"
    };
  }
}

// Request to get a signature certificate by ID.
message GetSignatureCertificateRequest {
  // ID of the signature certificate to return.
  string signature_certificate_id = 1 [(required) = true, (length) = "<=50"];
}

// Request to list signature certificates for a SAML application.
message ListSignatureCertificatesRequest {
  // ID of the SAML application to list certificates for.
  string application_id = 1 [(required) = true, (length) = "<=50"];
  // The maximum number of results per page to return.
  int64 page_size = 2 [(value) = "0-1000"];
  // Page token for pagination.
  string page_token = 3 [(length) = "<=2000"];
  // A filter expression that filters resources listed in the response.
  string filter = 4 [(length) = "<=1000"];
}

// Response message for [SignatureCertificateService.List].
message ListSignatureCertificatesResponse {
  // List of signature certificates.
  repeated SignatureCertificate signature_certificates = 1;
  // Token for getting the next page of the list.
  string next_page_token = 2;
}

// Request to create a new signature certificate.
message CreateSignatureCertificateRequest {
  // ID of the SAML application to create the certificate for.
  string application_id = 1 [(required) = true, (length) = "<=50"];
  // Name of the signature certificate.
  // The name is unique within the application. 3-63 characters long.
  string name = 2 [(pattern) = "([a-z]([-a-z0-9]{0,61}[a-z0-9])?)?"];
  // Description of the signature certificate. 0-256 characters long.
  string description = 3 [(length) = "<=256"];
}

// Metadata for the [SignatureCertificateService.Create] operation.
message CreateSignatureCertificateMetadata {
  // ID of the signature certificate that is being created.
  string signature_certificate_id = 1;
}

// Request to update an existing signature certificate.
message UpdateSignatureCertificateRequest {
  // ID of the signature certificate to update.
  string signature_certificate_id = 1 [(required) = true, (length) = "<=50"];
  // Field mask that specifies which fields of the certificate are going to be updated.
  google.protobuf.FieldMask update_mask = 2;
  // New name for the signature certificate.
  string name = 3 [(pattern) = "|[a-z]([-a-z0-9]{0,61}[a-z0-9])?"];
  // New description for the signature certificate.
  string description = 4 [(length) = "<=256"];
}

// Metadata for the [SignatureCertificateService.Update] operation.
message UpdateSignatureCertificateMetadata {
  // ID of the signature certificate that is being updated.
  string signature_certificate_id = 1;
}

// Request to delete a signature certificate.
message DeleteSignatureCertificateRequest {
  // ID of the signature certificate to delete.
  string signature_certificate_id = 1 [(length) = "<=50"];
}

// Metadata for the [SignatureCertificateService.Delete] operation.
message DeleteSignatureCertificateMetadata {
  // ID of the signature certificate that is being deleted.
  string signature_certificate_id = 1;
}
